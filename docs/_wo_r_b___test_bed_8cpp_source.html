<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>World of Rigid Bodies (WoRB): WoRB_TestBed.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">World of Rigid Bodies (WoRB)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_wo_r_b___test_bed_8cpp.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WoRB_TestBed.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_wo_r_b___test_bed_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**</span>
<a name="l00002"></a>00002 <span class="comment"> *  @file      WoRB_TestBed.cpp</span>
<a name="l00003"></a>00003 <span class="comment"> *  @brief     Implementation of the WoRB_TestBed, a GLUT based WoRB application.</span>
<a name="l00004"></a>00004 <span class="comment"> *  @author    Mikica Kocic</span>
<a name="l00005"></a>00005 <span class="comment"> *  @version   0.3</span>
<a name="l00006"></a>00006 <span class="comment"> *  @date      2012-05-04</span>
<a name="l00007"></a>00007 <span class="comment"> *  @copyright GNU Public License.</span>
<a name="l00008"></a>00008 <span class="comment"> */</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="_wo_r_b_8h.html" title="The World of Rigid Bodies (WoRB) Simulation Framework.">WoRB.h</a>&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="_utilities_8h.html" title="Declarations for various GLUT utilites for a rigid body application.">Utilities.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="_wo_r_b___test_bed_8h.html" title="Definitions for the WoRB_TestBed, which encapsulates a GLUT based test-bed application based on the W...">WoRB_TestBed.h</a>&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;cstdio&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::min</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="keyword">using namespace </span>WoRB;
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00020"></a>00020 <span class="comment"></span><span class="comment">// Destructor. Deallocates all objects.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a><a class="code" href="class_wo_r_b___test_bed.html#afc25c24012514e54eb53204914007fbb">00022</a> <a class="code" href="class_wo_r_b___test_bed.html#afc25c24012514e54eb53204914007fbb" title="Deallocates all objects.">WoRB_TestBed::~WoRB_TestBed</a> ()
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024     <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i )
<a name="l00025"></a>00025     {
<a name="l00026"></a>00026         <span class="keyword">delete</span> *i;
<a name="l00027"></a>00027     }
<a name="l00028"></a>00028 
<a name="l00029"></a>00029     Objects.clear ();
<a name="l00030"></a>00030 
<a name="l00031"></a>00031     IsInitialized = <span class="keyword">false</span>;
<a name="l00032"></a>00032 }
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00035"></a>00035 <span class="comment"></span><span class="comment">// Runs the simulation and rendering.</span>
<a name="l00036"></a>00036 <span class="comment">//</span>
<a name="l00037"></a><a class="code" href="class_wo_r_b___test_bed.html#aba0ad39269ed2c12748bdf08337e9710">00037</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#aba0ad39269ed2c12748bdf08337e9710" title="Runs the simulation and rendering.">WoRB_TestBed::Run</a> ()
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;WoRB: WoRB_TestBed: Run\n&quot;</span> );
<a name="l00040"></a>00040 
<a name="l00041"></a>00041     OnProcessData (); <span class="comment">// Process initial simulation data</span>
<a name="l00042"></a>00042     
<a name="l00043"></a>00043     glutPopWindow ();
<a name="l00044"></a>00044 
<a name="l00045"></a>00045     <span class="keywordflow">while</span> ( IsRunning )
<a name="l00046"></a>00046     {
<a name="l00047"></a>00047         Simulate ();
<a name="l00048"></a>00048         glutMainLoopEvent ();
<a name="l00049"></a>00049     }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     glutDestroyWindow( WindowId );
<a name="l00052"></a>00052     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 10; ++i ) {
<a name="l00053"></a>00053         glutMainLoopEvent ();
<a name="l00054"></a>00054     }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;WoRB: Destroyed GLUT window %d\n&quot;</span>, WindowId );
<a name="l00057"></a>00057 
<a name="l00058"></a>00058     IsInitialized = <span class="keyword">false</span>;
<a name="l00059"></a>00059 }
<a name="l00060"></a>00060 <span class="comment"></span>
<a name="l00061"></a>00061 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00062"></a>00062 <span class="comment"></span><span class="comment">// Delayed constructor</span>
<a name="l00063"></a>00063 <span class="comment">//</span>
<a name="l00064"></a><a class="code" href="class_wo_r_b___test_bed.html#a2a562a62e7657521c2554bd02033d2d2">00064</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a2a562a62e7657521c2554bd02033d2d2" title="Delayed constructor; after all static members are initialized.">WoRB_TestBed::Initialize</a> ()
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;WoRB: WoRB_TestBed: Initialize\n&quot;</span> );
<a name="l00067"></a>00067 
<a name="l00068"></a>00068     WindowTitle = <span class="stringliteral">&quot;Lab4: World of Rigid Bodies&quot;</span>;
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     <span class="comment">// Initialize all properties to default values</span>
<a name="l00071"></a>00071     <span class="comment">//</span>
<a name="l00072"></a>00072     TestSuite            = 0;      <span class="comment">// Start test-suite #0</span>
<a name="l00073"></a>00073     IsInitialized        = <span class="keyword">false</span>;  <span class="comment">// Not initialized yet</span>
<a name="l00074"></a>00074     IsRunning            = <span class="keyword">true</span>;   <span class="comment">// Main-loop ends, when set to false</span>
<a name="l00075"></a>00075     IsPaused             = <span class="keyword">false</span>;  <span class="comment">// Is simulation paused: no</span>
<a name="l00076"></a>00076     AutoPause            = <span class="keyword">false</span>;  <span class="comment">// Is single-step mode: no</span>
<a name="l00077"></a>00077     Wireframe            = <span class="keyword">false</span>;  <span class="comment">// Show bodies in wireframe instead of solid: no</span>
<a name="l00078"></a>00078     ShowBodyAxes         = <span class="keyword">true</span>;   <span class="comment">// Show body axes: yes</span>
<a name="l00079"></a>00079     ShowFloorMirror      = <span class="keyword">false</span>;  <span class="comment">// Show objects mirrored in the floor: no</span>
<a name="l00080"></a>00080     ShowContacts         = <span class="keyword">false</span>;  <span class="comment">// Show contact normals: no</span>
<a name="l00081"></a>00081     ShowTrajectories     = <span class="keyword">false</span>;  <span class="comment">// Show object&#39;s trajectories: no</span>
<a name="l00082"></a>00082     ShowStateVariables   = <span class="keyword">true</span>;   <span class="comment">// Show system state variables: yes</span>
<a name="l00083"></a>00083     ShowHelp             = <span class="keyword">true</span>;   <span class="comment">// Show short help: yes</span>
<a name="l00084"></a>00084     GridTickLength       = 1.0;    <span class="comment">// Tick size of the grid, in meters</span>
<a name="l00085"></a>00085     GridTicks            = 50;     <span class="comment">// Number of ticks in the grid</span>
<a name="l00086"></a>00086     TimeStep             = 0.01;   <span class="comment">// Integrator time-step, in seconds</span>
<a name="l00087"></a>00087     TimeStepsPerFrame    = 1;      <span class="comment">// Number of time-steps solved per one video frame</span>
<a name="l00088"></a>00088     TimeStepsPerSnapshot = 20;     <span class="comment">// Number of time-steps per one trajectory snapshot</span>
<a name="l00089"></a>00089     CameraZoom           = 15.0;   <span class="comment">// Position in m, from the coordinate system origin</span>
<a name="l00090"></a>00090     CameraLookAt.x       = -2.0;   <span class="comment">// Look at x = -2 m</span>
<a name="l00091"></a>00091     CameraLookAt.y       = 2.0;    <span class="comment">// Look at y = 2 m (height)</span>
<a name="l00092"></a>00092     CameraLookAt.z       = 0.0;    <span class="comment">// Look at z = 0 m</span>
<a name="l00093"></a>00093     CameraAngle          = 55.0;   <span class="comment">// Angle in degrees, left/right of x-axis</span>
<a name="l00094"></a>00094     CameraElevation      = 25.0;   <span class="comment">// Angle in degres, up/bellow the horizon</span>
<a name="l00095"></a>00095     FollowObject         = 0;      <span class="comment">// Follow the first object (with camera)</span>
<a name="l00096"></a>00096     LastDisplayTime      = 0.0;    <span class="comment">// Force immediate update</span>
<a name="l00097"></a>00097     FinalTime            = 0.0;    <span class="comment">// No final (when simulation ends) time</span>
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 <span class="comment"></span>
<a name="l00100"></a>00100 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00101"></a>00101 <span class="comment"></span><span class="comment">// Dumps all parameter values.</span>
<a name="l00102"></a>00102 <span class="comment">//</span>
<a name="l00103"></a><a class="code" href="class_wo_r_b___test_bed.html#a44703080ea5202b1949a0f275729f702">00103</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a44703080ea5202b1949a0f275729f702" title="Dumps all parameter values using Printf().">WoRB_TestBed::Dump</a> ()<span class="keyword"> const</span>
<a name="l00104"></a>00104 <span class="keyword"></span>{
<a name="l00105"></a>00105     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;IsInitialized        : %s\n&quot;</span>,  IsInitialized       ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00106"></a>00106     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;IsRunning            : %s\n&quot;</span>,  IsRunning           ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00107"></a>00107     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;IsPaused             : %s\n&quot;</span>,  IsPaused            ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00108"></a>00108     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;AutoPause            : %s\n&quot;</span>,  AutoPause           ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00109"></a>00109     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Wireframe            : %s\n&quot;</span>,  Wireframe           ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00110"></a>00110     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;ShowBodyAxes         : %s\n&quot;</span>,  ShowBodyAxes        ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00111"></a>00111     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;ShowFloorMirror      : %s\n&quot;</span>,  ShowFloorMirror     ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00112"></a>00112     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;ShowContacts         : %s\n&quot;</span>,  ShowContacts        ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00113"></a>00113     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;ShowTrajectories     : %s\n&quot;</span>,  ShowTrajectories    ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00114"></a>00114     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;ShowStateVariables   : %s\n&quot;</span>,  ShowStateVariables  ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00115"></a>00115     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;ShowHelp             : %s\n&quot;</span>,  ShowHelp            ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span> );
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;GridTickLength       : %g m\n&quot;</span>, GridTickLength       );
<a name="l00118"></a>00118     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;GridTicks            : %d\n&quot;</span>,   GridTicks            );
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;TimeStep             : %g s\n&quot;</span>, TimeStep             );
<a name="l00121"></a>00121     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;TimeStepsPerFrame    : %u\n&quot;</span>,   TimeStepsPerFrame    );
<a name="l00122"></a>00122     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;TimeStepsPerSnapshot : %u\n&quot;</span>,   TimeStepsPerSnapshot );
<a name="l00123"></a>00123     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;FinalTime            : %g s\n&quot;</span>, FinalTime            );
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;FollowObject         : %lu\n&quot;</span>,  FollowObject         );
<a name="l00126"></a>00126     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;CameraAngle          : %g°\n&quot;</span>,  CameraAngle          );
<a name="l00127"></a>00127     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;CameraElevation      : %g°\n&quot;</span>,  CameraElevation      );
<a name="l00128"></a>00128     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;CameraZoom           : %g m\n&quot;</span>, CameraZoom           );
<a name="l00129"></a>00129     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;CameraLookAt         : [ %g, %g, %g ] m\n&quot;</span>, 
<a name="l00130"></a>00130         CameraLookAt.x, CameraLookAt.y, CameraLookAt.z );
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="comment">// Now display objects in the system</span>
<a name="l00133"></a>00133     <span class="comment">//</span>
<a name="l00134"></a>00134     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; Objects.size (); ++i )
<a name="l00135"></a>00135     {
<a name="l00136"></a>00136         <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_geometry.html" title="Represents a geometry used to detect collisions against.">Geometry</a>&amp;  g = Objects.at(i)-&gt;GetGeometry ();
<a name="l00137"></a>00137         <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_rigid_body.html" title="Encapsulates a rigid body.">RigidBody</a>&amp; b = Objects.at(i)-&gt;GetBody ();
<a name="l00138"></a>00138 
<a name="l00139"></a>00139         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;\nObject %d\n&quot;</span>, i + 1 );
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Geometry         : %s\n&quot;</span>, g.<a class="code" href="class_wo_r_b_1_1_geometry.html#a44e061b5290391492c96fea5be8e7b16" title="Returns class of the geometry as a string.">GetName</a> () );
<a name="l00142"></a>00142 
<a name="l00143"></a>00143         <span class="keywordflow">if</span> ( g.<a class="code" href="class_wo_r_b_1_1_geometry.html#a8190a3d58a0dcd3b6940a57588cfcf44">IsSphere</a> () )
<a name="l00144"></a>00144         {
<a name="l00145"></a>00145             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_sphere.html" title="Encapsulates a sphere.">Sphere</a>&amp; s = (<span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_sphere.html" title="Encapsulates a sphere.">Sphere</a>&amp;)g;
<a name="l00146"></a>00146             <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Radius           : %g m\n&quot;</span>, s.<a class="code" href="class_wo_r_b_1_1_sphere.html#af4d0454c53ef311aa99bd81f356c8710" title="Holds the radius of the sphere.">Radius</a> );
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( g.<a class="code" href="class_wo_r_b_1_1_geometry.html#a820d1b377d856264b4c8620184993485">IsCuboid</a> () )
<a name="l00149"></a>00149         {
<a name="l00150"></a>00150             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_cuboid.html" title="Encapsulates a cuboid (rectangular parallelepiped).">Cuboid</a>&amp; c = (<span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_cuboid.html" title="Encapsulates a cuboid (rectangular parallelepiped).">Cuboid</a>&amp;)g;
<a name="l00151"></a>00151             <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Half-Extent      : [ %g, %g, %g ] m\n&quot;</span>, 
<a name="l00152"></a>00152                 c.<a class="code" href="class_wo_r_b_1_1_cuboid.html#a9ecf78f593c8a6f2e9916669ae14a9bd" title="Holds the half-extent of the cuboid along each of its local axes.">HalfExtent</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, c.<a class="code" href="class_wo_r_b_1_1_cuboid.html#a9ecf78f593c8a6f2e9916669ae14a9bd" title="Holds the half-extent of the cuboid along each of its local axes.">HalfExtent</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, c.<a class="code" href="class_wo_r_b_1_1_cuboid.html#a9ecf78f593c8a6f2e9916669ae14a9bd" title="Holds the half-extent of the cuboid along each of its local axes.">HalfExtent</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a> );
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Mass             : %g kg\n&quot;</span>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a64b4ae1be417963de423e542f290d91e" title="Gets the mass of the rigid body.">Mass</a> () );
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Position         : [ %g, %g, %g | %g ] m\n&quot;</span>, 
<a name="l00158"></a>00158             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> );
<a name="l00159"></a>00159 
<a name="l00160"></a>00160         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Orientation      : [ %g, %g, %g | %g ]\n&quot;</span>, 
<a name="l00161"></a>00161             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a7f5e3a855d14a7f74b3cfaf752e93eab" title="Holds the angular orientation of the rigid body in world space.">Orientation</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a7f5e3a855d14a7f74b3cfaf752e93eab" title="Holds the angular orientation of the rigid body in world space.">Orientation</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a7f5e3a855d14a7f74b3cfaf752e93eab" title="Holds the angular orientation of the rigid body in world space.">Orientation</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a7f5e3a855d14a7f74b3cfaf752e93eab" title="Holds the angular orientation of the rigid body in world space.">Orientation</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> );
<a name="l00162"></a>00162 
<a name="l00163"></a>00163         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Linear Momentum  : [ %g, %g, %g | %g ] kg m s^-1\n&quot;</span>, 
<a name="l00164"></a>00164             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ac71747daba2769951cdf91b6eab4cbfa" title="Holds the linear momentum of the rigid body in world space.">LinearMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ac71747daba2769951cdf91b6eab4cbfa" title="Holds the linear momentum of the rigid body in world space.">LinearMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, 
<a name="l00165"></a>00165             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ac71747daba2769951cdf91b6eab4cbfa" title="Holds the linear momentum of the rigid body in world space.">LinearMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ac71747daba2769951cdf91b6eab4cbfa" title="Holds the linear momentum of the rigid body in world space.">LinearMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> );
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Angular Momentum : [ %g, %g, %g | %g ] kg m^2 s^-1m\n&quot;</span>, 
<a name="l00168"></a>00168             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a46b32949722d0f80a52c3b99bf4e2569" title="Holds the angular momentum of the rigid body in world space.">AngularMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a46b32949722d0f80a52c3b99bf4e2569" title="Holds the angular momentum of the rigid body in world space.">AngularMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, 
<a name="l00169"></a>00169             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a46b32949722d0f80a52c3b99bf4e2569" title="Holds the angular momentum of the rigid body in world space.">AngularMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a46b32949722d0f80a52c3b99bf4e2569" title="Holds the angular momentum of the rigid body in world space.">AngularMomentum</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> );
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Velocity         : [ %g, %g, %g | %g ] m s^-1\n&quot;</span>, 
<a name="l00172"></a>00172             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> );
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Angular Velocity : [ %g, %g, %g | %g ] s^-1\n&quot;</span>, 
<a name="l00175"></a>00175             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a0a3597c53a3bd95f51c5e77c0bd74062" title="Holds the angular velocity of the rigid body in world space.">AngularVelocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a0a3597c53a3bd95f51c5e77c0bd74062" title="Holds the angular velocity of the rigid body in world space.">AngularVelocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, 
<a name="l00176"></a>00176             b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a0a3597c53a3bd95f51c5e77c0bd74062" title="Holds the angular velocity of the rigid body in world space.">AngularVelocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a0a3597c53a3bd95f51c5e77c0bd74062" title="Holds the angular velocity of the rigid body in world space.">AngularVelocity</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> );
<a name="l00177"></a>00177 
<a name="l00178"></a>00178         <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;Kinetic Energy   : %g J\n&quot;</span>, b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a3e083370baa33e846dd8c0a62a4be75b" title="Holds the total kinetic energy of the rigid body.">KineticEnergy</a> );
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180 }
<a name="l00181"></a>00181 <span class="comment"></span>
<a name="l00182"></a>00182 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00183"></a>00183 <span class="comment"></span><span class="comment">// Creates the GLUT window and initializes the view.</span>
<a name="l00184"></a>00184 <span class="comment">//</span>
<a name="l00185"></a><a class="code" href="class_wo_r_b___test_bed.html#ad70ed2a264312e675b3eff4768bd1406">00185</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#ad70ed2a264312e675b3eff4768bd1406" title="Creates the GLUT window and initializes the view.">WoRB_TestBed::SetupAnimation</a> ()
<a name="l00186"></a>00186 {
<a name="l00187"></a>00187     <span class="comment">// Setup common execution options for GLUT: not to call exit() when finished</span>
<a name="l00188"></a>00188     <span class="comment">//</span>
<a name="l00189"></a>00189     glutSetOption( GLUT_ACTION_ON_WINDOW_CLOSE, GLUT_ACTION_CONTINUE_EXECUTION );
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     <span class="comment">// Create GLUT window</span>
<a name="l00192"></a>00192     <span class="comment">//</span>
<a name="l00193"></a>00193     glutInitDisplayMode( GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH );
<a name="l00194"></a>00194     glutInitWindowSize( 800, 600 );
<a name="l00195"></a>00195     
<a name="l00196"></a>00196     WindowId = glutCreateWindow( WindowTitle );
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <a class="code" href="namespace_wo_r_b.html#ab4fc0069851f8e164956e6729bd1ebd5" title="Brings the current GLUT window to the foreground.">glutForegroundWindow</a> ();
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <a class="code" href="namespace_wo_r_b.html#a1daf5df6226659812376d1cd23aa6d89" title="User defined ANSI C printf-style output routine.">Printf</a>( <span class="stringliteral">&quot;WoRB: Created GLUT window %d\n&quot;</span>, WindowId );
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <span class="comment">// Initialize ambient light</span>
<a name="l00203"></a>00203     <span class="comment">//</span>
<a name="l00204"></a>00204     GLfloat lightAmbient[] = { 0.5, 0.5, 0.5, 1 };
<a name="l00205"></a>00205     glLightfv( GL_LIGHT0, GL_AMBIENT, lightAmbient );
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     GLfloat lightDiffuse[] = { 1, 1, 1, 1 };
<a name="l00208"></a>00208     glLightfv( GL_LIGHT0, GL_DIFFUSE, lightDiffuse );
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     glEnable( GL_LIGHT0 );
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     glClearColor( 1.0f, 1.0f, 1.0f, 1.0f );
<a name="l00213"></a>00213     glEnable( GL_DEPTH_TEST );
<a name="l00214"></a>00214     glShadeModel( GL_SMOOTH );
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <span class="comment">// Finally, setup camera position</span>
<a name="l00217"></a>00217     <span class="comment">//</span>
<a name="l00218"></a>00218     SetupProjection ();
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="comment">// .. and mark the instance as initialized.</span>
<a name="l00221"></a>00221     <span class="comment">//</span>
<a name="l00222"></a>00222     IsInitialized = <span class="keyword">true</span>;
<a name="l00223"></a>00223 }
<a name="l00224"></a>00224 <span class="comment"></span>
<a name="l00225"></a>00225 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00226"></a>00226 <span class="comment"></span><span class="comment">// Sets the projection characteristics of the camera.</span>
<a name="l00227"></a>00227 <span class="comment">//</span>
<a name="l00228"></a><a class="code" href="class_wo_r_b___test_bed.html#ad31766e180ffa5144cf45e2408b31d46">00228</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#ad31766e180ffa5144cf45e2408b31d46" title="Sets the projection characteristics of the camera.">WoRB_TestBed::SetupProjection</a> ()
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230     <span class="keywordtype">double</span> aspect = double( glutGet( GLUT_WINDOW_WIDTH ) ) 
<a name="l00231"></a>00231                     / std::max( 1, glutGet( GLUT_WINDOW_HEIGHT ) );
<a name="l00232"></a>00232 
<a name="l00233"></a>00233     aspect = std::min( 2e3, std::max( -2e3, aspect ) );
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     glMatrixMode( GL_PROJECTION );
<a name="l00236"></a>00236     glLoadIdentity ();
<a name="l00237"></a>00237     gluPerspective( 45.0, aspect, 1.0, 500.0 );
<a name="l00238"></a>00238     glMatrixMode( GL_MODELVIEW );
<a name="l00239"></a>00239 }
<a name="l00240"></a>00240 <span class="comment"></span>
<a name="l00241"></a>00241 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00242"></a>00242 <span class="comment"></span><span class="comment">// Updates the current state (solves ODE) of the system.</span>
<a name="l00243"></a>00243 <span class="comment">//</span>
<a name="l00244"></a><a class="code" href="class_wo_r_b___test_bed.html#ab9e7412d0c823f837d6256f2d8bd9fbd">00244</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#ab9e7412d0c823f837d6256f2d8bd9fbd" title="Updates the current state of the scene.">WoRB_TestBed::Simulate</a> ()
<a name="l00245"></a>00245 {
<a name="l00246"></a>00246     <span class="comment">// Reconfigure the test-bed, if requested</span>
<a name="l00247"></a>00247     <span class="comment">//</span>
<a name="l00248"></a>00248     <span class="keywordflow">if</span> ( TestSuite &gt;= 0 )
<a name="l00249"></a>00249     {
<a name="l00250"></a>00250         ReconfigureTestBed ();
<a name="l00251"></a>00251         TestSuite = -1; <span class="comment">// Set the flag to &#39;initialized&#39;</span>
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="comment">// Just refresh display and sleep some time, when paused</span>
<a name="l00255"></a>00255     <span class="comment">//</span>
<a name="l00256"></a>00256     <span class="keywordflow">if</span> ( IsPaused )
<a name="l00257"></a>00257     {
<a name="l00258"></a>00258         glutPostRedisplay ();
<a name="l00259"></a>00259 
<a name="l00260"></a>00260         <span class="comment">// Just wait</span>
<a name="l00261"></a>00261         <span class="keywordtype">double</span> durationMs = TimeStep * TimeStepsPerFrame * 1e3; <span class="comment">// in milliseconds</span>
<a name="l00262"></a>00262         <a class="code" href="namespace_wo_r_b.html#a3adc8f2b66f037fdcdc01ec003994496" title="Pauses execution for the given amount of milliseconds.">Pause</a>( (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)durationMs );
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="keywordflow">return</span>;
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <span class="comment">// If not paused, solve ODE</span>
<a name="l00268"></a>00268     <span class="comment">//</span>
<a name="l00269"></a>00269     worb.SolveODE( TimeStep );
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="comment">// Process data calculated during the simulation, e.g. save data.</span>
<a name="l00272"></a>00272     <span class="comment">//</span>
<a name="l00273"></a>00273     OnProcessData ();
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keywordflow">if</span> ( FinalTime &gt; 0 &amp;&amp; worb.Time &gt;= FinalTime )
<a name="l00276"></a>00276     {
<a name="l00277"></a>00277         IsRunning = <span class="keyword">false</span>;
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     <span class="comment">// Take a snapshot of object&#39;s positions, when snapshot time comes</span>
<a name="l00281"></a>00281     <span class="comment">//</span>
<a name="l00282"></a>00282     <span class="keywordflow">if</span> ( worb.TimeStepCount % TimeStepsPerSnapshot == 0 &amp;&amp; ShowTrajectories )
<a name="l00283"></a>00283     {
<a name="l00284"></a>00284         <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i )
<a name="l00285"></a>00285         {
<a name="l00286"></a>00286             <span class="keywordflow">if</span> ( (*i)-&gt;ShowTrajectory ) {
<a name="l00287"></a>00287                 <a class="code" href="struct_wo_r_b___test_bed_1_1_trajectory_item.html" title="Represents trajectory snapshot item (position and orientation of the rigid body).">TrajectoryItem</a> ti;
<a name="l00288"></a>00288                 ti.<a class="code" href="struct_wo_r_b___test_bed_1_1_trajectory_item.html#abdedf18f380c3a65df249de2aab2b144">object</a> = *i;
<a name="l00289"></a>00289                 (*i)-&gt;<a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#ace5b8a44158af99f4de597e7dc1da215" title="Gets underlying rigid body.">GetBody</a> ().<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ab4140317241df453398dd238eae87616" title="Holds a combined translation/rotation matrix for converting from body-fixed local coordinates into wo...">ToWorld</a>.<a class="code" href="class_wo_r_b_1_1_q_tensor.html#ac6480f9f2c3a7c34601fddde8a226da4" title="Gets an OpenGL transform representing a combined translation and rotation.">GetGLTransform</a>( ti.<a class="code" href="struct_wo_r_b___test_bed_1_1_trajectory_item.html#acf36960bb63e2173d1d5365060c4b532">matrix</a> );
<a name="l00290"></a>00290                 Trajectories.push_back( ti );
<a name="l00291"></a>00291             }
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294 
<a name="l00295"></a>00295     <span class="comment">// Animate objects, when (animation frame) time comes </span>
<a name="l00296"></a>00296     <span class="comment">//</span>
<a name="l00297"></a>00297     <span class="keywordflow">if</span> ( worb.TimeStepCount % TimeStepsPerFrame == 0 || AutoPause )
<a name="l00298"></a>00298     {
<a name="l00299"></a>00299         glutPostRedisplay ();
<a name="l00300"></a>00300     }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <span class="comment">// Clear auto-pause flag, i.e. force user to set `IsPaused = false` </span>
<a name="l00303"></a>00303     <span class="comment">// and `AutoPause = true` for the next simulation single-step.</span>
<a name="l00304"></a>00304     <span class="comment">//</span>
<a name="l00305"></a>00305     <span class="keywordflow">if</span> ( AutoPause )
<a name="l00306"></a>00306     {
<a name="l00307"></a>00307         AutoPause = <span class="keyword">false</span>;
<a name="l00308"></a>00308         IsPaused = <span class="keyword">true</span>;
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 <span class="comment"></span>
<a name="l00312"></a>00312 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00313"></a>00313 <span class="comment"></span><span class="comment">// Renders the current scene.</span>
<a name="l00314"></a>00314 <span class="comment">//</span>
<a name="l00315"></a><a class="code" href="class_wo_r_b___test_bed.html#a464a52ae7c841db4b61bef5603030a36">00315</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a464a52ae7c841db4b61bef5603030a36" title="Renders the current scene.">WoRB_TestBed::DisplayEventHandler</a> ()
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317     <span class="comment">// Adjust camera&#39;s &#39;look-at&#39; position depending on the selected object to follow</span>
<a name="l00318"></a>00318     <span class="comment">//</span>
<a name="l00319"></a>00319     <span class="keywordflow">if</span> ( FollowObject &lt; Objects.size () )
<a name="l00320"></a>00320     {
<a name="l00321"></a>00321          CameraLookAt = Objects.at( FollowObject )-&gt;GetBody ().Position;
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <span class="comment">// Clear the viewport and setup the camera direction</span>
<a name="l00325"></a>00325     <span class="comment">//</span>
<a name="l00326"></a>00326     glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );
<a name="l00327"></a>00327     glLoadIdentity ();
<a name="l00328"></a>00328 
<a name="l00329"></a>00329     gluLookAt( <span class="comment">/*eye*/</span> CameraZoom, 0, 0, <span class="comment">/*center*/</span> 0, 0, 0, <span class="comment">/*up*/</span> 0, 1, 0 );
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     glTranslated ( -CameraZoom,      0, 0    ); <span class="comment">// move away = zoom out</span>
<a name="l00332"></a>00332     glRotated    ( -CameraElevation, 0, 0, 1 ); <span class="comment">// z-rotate = elevation</span>
<a name="l00333"></a>00333     glRotated    (  CameraAngle,     0, 1, 0 ); <span class="comment">// y-rotate = angle</span>
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     glTranslated ( -CameraLookAt.x, -CameraLookAt.y, -CameraLookAt.z );
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     <span class="keywordflow">if</span> ( CameraElevation &gt;= -8.0 )
<a name="l00338"></a>00338     {
<a name="l00339"></a>00339         <span class="comment">// Render objects reflected in the floor (mirror)</span>
<a name="l00340"></a>00340         <span class="comment">//</span>
<a name="l00341"></a>00341         <span class="keywordflow">if</span> ( ShowFloorMirror )
<a name="l00342"></a>00342         {
<a name="l00343"></a>00343             glEnable( GL_DEPTH_TEST );
<a name="l00344"></a>00344             glEnable( GL_LIGHTING );
<a name="l00345"></a>00345             glEnable( GL_BLEND );
<a name="l00346"></a>00346 
<a name="l00347"></a>00347             glColorMaterial( GL_FRONT_AND_BACK, GL_DIFFUSE );
<a name="l00348"></a>00348             glEnable( GL_COLOR_MATERIAL );
<a name="l00349"></a>00349 
<a name="l00350"></a>00350             <span class="keyword">static</span> <span class="keyword">const</span> GLfloat lightPosition[] = { 1, -1, 0, 0 };
<a name="l00351"></a>00351             glLightfv( GL_LIGHT0, GL_POSITION, lightPosition );
<a name="l00352"></a>00352 
<a name="l00353"></a>00353             <span class="comment">// A transform matrix for rendering objects reflected in the floor</span>
<a name="l00354"></a>00354             <span class="comment">//</span>
<a name="l00355"></a>00355             <span class="keyword">static</span> <span class="keyword">const</span> GLdouble floorMirrorTransform [] =
<a name="l00356"></a>00356             {
<a name="l00357"></a>00357                 1,  0, 0, 0,
<a name="l00358"></a>00358                 0, -1, 0, 0,
<a name="l00359"></a>00359                 0,  0, 1, 0,
<a name="l00360"></a>00360                 0,  0, 0, 1
<a name="l00361"></a>00361             };
<a name="l00362"></a>00362 
<a name="l00363"></a>00363             glPushMatrix();
<a name="l00364"></a>00364             glMultMatrixd( floorMirrorTransform );
<a name="l00365"></a>00365 
<a name="l00366"></a>00366             <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i )
<a name="l00367"></a>00367             {
<a name="l00368"></a>00368                 (*i)-&gt;Render( <a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#a452357ec8e717cfd4cd7ebf245896e5aa696fad4290042b182f2e61cad1df901c" title="Render floor mirror image of the body.">GLUT_Renderer::FloorMirror</a> );
<a name="l00369"></a>00369             }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371             glPopMatrix();
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         glDisable( GL_COLOR_MATERIAL );
<a name="l00375"></a>00375         glDisable( GL_LIGHTING );
<a name="l00376"></a>00376         glDisable( GL_DEPTH_TEST );
<a name="l00377"></a>00377         glDisable( GL_BLEND );
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     <span class="comment">// Render a tiled ground plane i.e. the xz-grid</span>
<a name="l00381"></a>00381     <span class="comment">//</span>
<a name="l00382"></a>00382     glColor3d( 0.95, 0.95, 0.85 );
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     glBegin( GL_LINES );
<a name="l00385"></a>00385     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> x = -GridTicks; x &lt;= GridTicks; ++x )
<a name="l00386"></a>00386     {
<a name="l00387"></a>00387         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> z = -GridTicks; z &lt;= GridTicks; ++z ) 
<a name="l00388"></a>00388         {
<a name="l00389"></a>00389             glVertex3d(  x * GridTickLength, 0, -z * GridTickLength );
<a name="l00390"></a>00390             glVertex3d(  x * GridTickLength, 0,  z * GridTickLength );
<a name="l00391"></a>00391             glVertex3d(  x * GridTickLength, 0,  z * GridTickLength );
<a name="l00392"></a>00392             glVertex3d( -x * GridTickLength, 0,  z * GridTickLength );
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395     glEnd ();
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <span class="comment">// Display the main axes</span>
<a name="l00398"></a>00398     <span class="comment">//</span>
<a name="l00399"></a>00399     <a class="code" href="namespace_wo_r_b.html#aa6e6700a62194685be88413dc6c5d0c0" title="Draws the world axes.">RenderAxes</a>( 10 * GridTickLength );
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="comment">// Render ground shadows of the objects</span>
<a name="l00402"></a>00402     <span class="comment">//</span>
<a name="l00403"></a>00403     glEnable( GL_BLEND );
<a name="l00404"></a>00404     glDisable( GL_DEPTH_TEST );
<a name="l00405"></a>00405     glBlendFunc( GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA );
<a name="l00406"></a>00406 
<a name="l00407"></a>00407     glColor4d( 0.1, 0.1, 0, 0.1 ); 
<a name="l00408"></a>00408     <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i )
<a name="l00409"></a>00409     {
<a name="l00410"></a>00410         (*i)-&gt;Render( <a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#a452357ec8e717cfd4cd7ebf245896e5aa470bc88c64acecc9766ac8261be40a07" title="Render the body shadow (flattened body)">GLUT_Renderer::BodyShadow</a> );
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="comment">// Render the objects themselves</span>
<a name="l00414"></a>00414     <span class="comment">//</span>
<a name="l00415"></a>00415     glEnable( GL_LIGHTING );
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     <span class="keyword">static</span> <span class="keyword">const</span> GLfloat lightPositionForMirror [] = { 1, 1, 0, 0 };
<a name="l00418"></a>00418     glLightfv( GL_LIGHT0, GL_POSITION, lightPositionForMirror );
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     glColorMaterial( GL_FRONT_AND_BACK, GL_DIFFUSE );
<a name="l00421"></a>00421     glEnable( GL_COLOR_MATERIAL );
<a name="l00422"></a>00422 
<a name="l00423"></a>00423     <span class="keywordflow">if</span> ( Wireframe ) {
<a name="l00424"></a>00424         glPolygonMode( GL_FRONT_AND_BACK, GL_LINE );
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426     <span class="keywordflow">else</span> {
<a name="l00427"></a>00427         glEnable( GL_DEPTH_TEST );
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i )
<a name="l00431"></a>00431     {
<a name="l00432"></a>00432         (*i)-&gt;Render( <a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#a452357ec8e717cfd4cd7ebf245896e5aa5f8e26d4a9cdf3df622a5f4a66fa1da3" title="Render the body itself.">GLUT_Renderer::BodyShape</a> );
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     glPolygonMode( GL_FRONT_AND_BACK, GL_FILL );
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     glDisable( GL_COLOR_MATERIAL );
<a name="l00438"></a>00438     glDisable( GL_LIGHTING );
<a name="l00439"></a>00439 
<a name="l00440"></a>00440     <span class="comment">// Render trajectories</span>
<a name="l00441"></a>00441     <span class="comment">//</span>
<a name="l00442"></a>00442     <span class="keywordflow">if</span> ( ShowTrajectories )
<a name="l00443"></a>00443     {
<a name="l00444"></a>00444         <span class="keywordflow">for</span> ( Trajectory::iterator i = Trajectories.begin(); i != Trajectories.end(); ++i )
<a name="l00445"></a>00445         {
<a name="l00446"></a>00446             (*i).object-&gt;RenderWireframe( (*i).matrix );
<a name="l00447"></a>00447         }
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     glDisable( GL_DEPTH_TEST );
<a name="l00451"></a>00451     glDisable( GL_BLEND );
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="comment">// Render any additional information</span>
<a name="l00454"></a>00454 
<a name="l00455"></a>00455     RenderDebugInfo ();
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     <span class="comment">// Update the display and swap double-buffers</span>
<a name="l00458"></a>00458     <span class="comment">//</span>
<a name="l00459"></a>00459     glFlush ();
<a name="l00460"></a>00460     glutSwapBuffers ();
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     <span class="comment">// Remember the current time</span>
<a name="l00463"></a>00463     <span class="comment">//</span>
<a name="l00464"></a>00464     <span class="keywordtype">double</span> currentTime = glutGet( GLUT_ELAPSED_TIME );
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="keywordtype">double</span> durationMs = TimeStep * TimeStepsPerFrame * 1e3; <span class="comment">// in milliseconds</span>
<a name="l00467"></a>00467     durationMs -= currentTime - LastDisplayTime;
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <span class="keywordflow">if</span> ( durationMs &gt; 0 ) {
<a name="l00470"></a>00470         <a class="code" href="namespace_wo_r_b.html#a3adc8f2b66f037fdcdc01ec003994496" title="Pauses execution for the given amount of milliseconds.">Pause</a>( (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)durationMs );
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     LastDisplayTime = currentTime;
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 <span class="comment"></span>
<a name="l00476"></a>00476 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00477"></a>00477 <span class="comment"></span><span class="comment">// Renders state variables and short help.</span>
<a name="l00478"></a>00478 <span class="comment">//</span>
<a name="l00479"></a><a class="code" href="class_wo_r_b___test_bed.html#a83e7eb268e5401fae4b8dea1784d8292">00479</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a83e7eb268e5401fae4b8dea1784d8292" title="Displays debugging information (like state variables) and short help.">WoRB_TestBed::RenderDebugInfo</a> ()
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481     <span class="comment">// Draw axes of the body</span>
<a name="l00482"></a>00482     <span class="comment">//</span>
<a name="l00483"></a>00483     <span class="keywordflow">if</span> ( ShowBodyAxes )
<a name="l00484"></a>00484     {
<a name="l00485"></a>00485         <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i )
<a name="l00486"></a>00486         {
<a name="l00487"></a>00487             (*i)-&gt;Render( <a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#a452357ec8e717cfd4cd7ebf245896e5aa4fded79873d1d848e4b1b947e061e887" title="Render the body axes.">GLUT_Renderer::BodyAxes</a> );
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="comment">// Display the state variables of the system</span>
<a name="l00492"></a>00492     <span class="comment">//</span>
<a name="l00493"></a>00493     <span class="keywordflow">if</span> ( ShowStateVariables )
<a name="l00494"></a>00494     {
<a name="l00495"></a>00495         <a class="code" href="class_wo_r_b_1_1_g_l_ortho_screen.html" title="Establishes temporarily orthogonal projection in screen coordinates.">GLOrthoScreen</a> _inScreenCoordinates; <span class="comment">// Establish temporary transform for text</span>
<a name="l00496"></a>00496 
<a name="l00497"></a>00497         glColor3d( 0, 0, 0.7 );
<a name="l00498"></a>00498 
<a name="l00499"></a>00499         <span class="keyword">const</span> <span class="keywordtype">double</span> E_k = worb.TotalKineticEnergy;
<a name="l00500"></a>00500         <span class="keyword">const</span> <span class="keywordtype">double</span> E_p = worb.TotalPotentialEnergy;
<a name="l00501"></a>00501         <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; p_tot = worb.TotalLinearMomentum;
<a name="l00502"></a>00502         <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; L_tot = worb.TotalAngularMomentum;
<a name="l00503"></a>00503 
<a name="l00504"></a>00504         <span class="keywordtype">int</span> row = glutGet( GLUT_WINDOW_HEIGHT ) - 20;
<a name="l00505"></a>00505         row = <a class="code" href="namespace_wo_r_b.html#ae56bf6d9619ad07b64e284f7699b62c7" title="Renders the given text to the given location in screen space on the window.">RenderPrintf</a>( 10, row, 
<a name="l00506"></a>00506             <span class="stringliteral">&quot;N = %4lu, t = %6.3lf%s\n&quot;</span>
<a name="l00507"></a>00507             <span class="stringliteral">&quot;E_t/k/p %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00508"></a>00508             <span class="stringliteral">&quot;p_tot   %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00509"></a>00509             <span class="stringliteral">&quot;L_tot   %12.3lf %12.3lf %12.3lf&quot;</span>,
<a name="l00510"></a>00510             worb.TimeStepCount, worb.Time,
<a name="l00511"></a>00511             IsPaused || AutoPause ? <span class="stringliteral">&quot; (Paused)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,
<a name="l00512"></a>00512             E_k + E_p, E_k, E_p,
<a name="l00513"></a>00513             p_tot.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, p_tot.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, p_tot.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>,
<a name="l00514"></a>00514             L_tot.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, L_tot.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, L_tot.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>
<a name="l00515"></a>00515         );
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         <span class="comment">// Display the state variables of the rigid bodies</span>
<a name="l00518"></a>00518         <span class="comment">//</span>
<a name="l00519"></a>00519         <span class="keywordtype">unsigned</span> nShown = unsigned( Objects.size () );
<a name="l00520"></a>00520         nShown = std::min( IsPaused || AutoPause ? 4u : 0u, nShown );
<a name="l00521"></a>00521         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; nShown; ++i )
<a name="l00522"></a>00522         {
<a name="l00523"></a>00523             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_rigid_body.html" title="Encapsulates a rigid body.">RigidBody</a>&amp;  b = Objects.at(i)-&gt;GetBody ();
<a name="l00524"></a>00524             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; x = b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>;
<a name="l00525"></a>00525             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; q = b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a7f5e3a855d14a7f74b3cfaf752e93eab" title="Holds the angular orientation of the rigid body in world space.">Orientation</a>;
<a name="l00526"></a>00526             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; p = b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ac71747daba2769951cdf91b6eab4cbfa" title="Holds the linear momentum of the rigid body in world space.">LinearMomentum</a>;
<a name="l00527"></a>00527             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; L = b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a46b32949722d0f80a52c3b99bf4e2569" title="Holds the angular momentum of the rigid body in world space.">AngularMomentum</a>;
<a name="l00528"></a>00528             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; v = b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a>;
<a name="l00529"></a>00529             <span class="keyword">const</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>&amp; w = b.<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a0a3597c53a3bd95f51c5e77c0bd74062" title="Holds the angular velocity of the rigid body in world space.">AngularVelocity</a>;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531             row = <a class="code" href="namespace_wo_r_b.html#ae56bf6d9619ad07b64e284f7699b62c7" title="Renders the given text to the given location in screen space on the window.">RenderPrintf</a>( 10, row, 
<a name="l00532"></a>00532                 <span class="stringliteral">&quot;(%d)   x %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00533"></a>00533                 <span class="stringliteral">&quot;      q %12.3lf %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00534"></a>00534                 <span class="stringliteral">&quot;      p %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00535"></a>00535                 <span class="stringliteral">&quot;      L %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00536"></a>00536                 <span class="stringliteral">&quot;      v %12.3lf %12.3lf %12.3lf\n&quot;</span>
<a name="l00537"></a>00537                 <span class="stringliteral">&quot;      w %12.3lf %12.3lf %12.3lf&quot;</span>,
<a name="l00538"></a>00538                 i + 1, x.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, x.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, x.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>,
<a name="l00539"></a>00539                        q.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, q.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, q.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>, q.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a>,
<a name="l00540"></a>00540                        p.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, p.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, p.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>,
<a name="l00541"></a>00541                        L.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, L.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, L.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>,
<a name="l00542"></a>00542                        v.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, v.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, v.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>,
<a name="l00543"></a>00543                        w.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, w.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, w.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a>
<a name="l00544"></a>00544             );
<a name="l00545"></a>00545         }
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="comment">// Display short help</span>
<a name="l00549"></a>00549     <span class="comment">//</span>
<a name="l00550"></a>00550     <span class="keywordflow">if</span> ( ShowHelp )
<a name="l00551"></a>00551     {
<a name="l00552"></a>00552         <a class="code" href="class_wo_r_b_1_1_g_l_ortho_screen.html" title="Establishes temporarily orthogonal projection in screen coordinates.">GLOrthoScreen</a> _inScreenCoordinates; <span class="comment">// Establish temporary transform for text</span>
<a name="l00553"></a>00553 
<a name="l00554"></a>00554         glColor3d( 0, 0, 0 );
<a name="l00555"></a>00555         <a class="code" href="namespace_wo_r_b.html#ae56bf6d9619ad07b64e284f7699b62c7" title="Renders the given text to the given location in screen space on the window.">RenderPrintf</a>( 10, 4 * 25, 
<a name="l00556"></a>00556             <span class="stringliteral">&quot;Shortcut keys:\n&quot;</span>
<a name="l00557"></a>00557             <span class="stringliteral">&quot;  1, 2, ... for different simulation\n&quot;</span>
<a name="l00558"></a>00558             <span class="stringliteral">&quot;  (P)ause, (S)ingle-step, (Q)uit\n&quot;</span>
<a name="l00559"></a>00559             <span class="stringliteral">&quot;  (A)xes, (V)ariables, (C)ontacts, (T)rajectories\n&quot;</span>
<a name="l00560"></a>00560             <span class="stringliteral">&quot;  (W)ireframe, Floor (M)irror, (F)ullscreen&quot;</span>
<a name="l00561"></a>00561         );
<a name="l00562"></a>00562         glColor3d( 0, 0, 1 );
<a name="l00563"></a>00563         <a class="code" href="namespace_wo_r_b.html#ae56bf6d9619ad07b64e284f7699b62c7" title="Renders the given text to the given location in screen space on the window.">RenderPrintf</a>( 10, 10, 
<a name="l00564"></a>00564             <span class="stringliteral">&quot;Camera: a= %+5.1lf, e= %+5.1lf, d= %+5.1lf, at= %+5.1lf %+5.1lf %+5.1lf&quot;</span>,
<a name="l00565"></a>00565             CameraAngle, CameraElevation, CameraZoom,
<a name="l00566"></a>00566             CameraLookAt.x, CameraLookAt.y,  CameraLookAt.z
<a name="l00567"></a>00567         );
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570     <span class="comment">// Display contact normals. </span>
<a name="l00571"></a>00571     <span class="comment">// Green between two objects, red between objects and scenery e.g. floor.</span>
<a name="l00572"></a>00572     <span class="comment">//</span>
<a name="l00573"></a>00573     <span class="keywordflow">if</span> ( ShowContacts )
<a name="l00574"></a>00574     {
<a name="l00575"></a>00575         glLineWidth( 3 );
<a name="l00576"></a>00576         glBegin( GL_LINES );
<a name="l00577"></a>00577 
<a name="l00578"></a>00578         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; worb.Collisions.Count (); ++i )
<a name="l00579"></a>00579         {
<a name="l00580"></a>00580             <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a> pos = worb.Collisions[i].Position;
<a name="l00581"></a>00581             <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a> n = worb.Collisions[i].Normal;
<a name="l00582"></a>00582             <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a> end = pos + n;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584             <span class="keywordflow">if</span> ( worb.Collisions[i].WithScenery () ) {
<a name="l00585"></a>00585                 glColor3d( 1, 0, 0 ); <span class="comment">// red body</span>
<a name="l00586"></a>00586             } <span class="keywordflow">else</span> {
<a name="l00587"></a>00587                 glColor3d( 0, 1, 0 ); <span class="comment">// green body</span>
<a name="l00588"></a>00588             }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590             glVertex3d( pos.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, pos.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, pos.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a> );
<a name="l00591"></a>00591             glVertex3d( end.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, end.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, end.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a> );
<a name="l00592"></a>00592 
<a name="l00593"></a>00593             pos = end;
<a name="l00594"></a>00594             end = pos + n * 0.1;
<a name="l00595"></a>00595 
<a name="l00596"></a>00596             glColor3d( 0, 0, 1 ); <span class="comment">// blue head</span>
<a name="l00597"></a>00597             glVertex3d( pos.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, pos.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, pos.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a> );
<a name="l00598"></a>00598             glVertex3d( end.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a28802efcda7cc375d5a45d3be1eaefc3" title="Holds i-component of the pure imaginary (vector) part.">x</a>, end.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a>, end.<a class="code" href="class_wo_r_b_1_1_quaternion.html#ac8db915c9c1fd87c962bc540731011f4" title="Holds k-component of the pure imaginary (vector) part.">z</a> );
<a name="l00599"></a>00599         }
<a name="l00600"></a>00600 
<a name="l00601"></a>00601         glEnd ();
<a name="l00602"></a>00602         glLineWidth( 1 );
<a name="l00603"></a>00603     }
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 <span class="comment"></span>
<a name="l00606"></a>00606 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00607"></a>00607 <span class="comment"></span><span class="comment">// Called when GLUT detects a mouse drag.</span>
<a name="l00608"></a>00608 <span class="comment">//</span>
<a name="l00609"></a><a class="code" href="class_wo_r_b___test_bed.html#a6909e060d295c09a1c77b4a673acc69b">00609</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a6909e060d295c09a1c77b4a673acc69b" title="Called when GLUT detects a mouse drag.">WoRB_TestBed::MotionEventHandler</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y )
<a name="l00610"></a>00610 {
<a name="l00611"></a>00611     <span class="keywordtype">int</span> modifiers = glutGetModifiers ();
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <span class="keywordflow">if</span> ( modifiers == GLUT_ACTIVE_CTRL &amp;&amp; LastMouse.state == GLUT_DOWN )
<a name="l00614"></a>00614     {
<a name="l00615"></a>00615         CameraZoom += 0.5 * ( y - LastMouse.y );
<a name="l00616"></a>00616         CameraZoom = std::max( 0.5, std::min( 300.0, CameraZoom ) );
<a name="l00617"></a>00617     }
<a name="l00618"></a>00618     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( modifiers == GLUT_ACTIVE_SHIFT &amp;&amp; LastMouse.state == GLUT_DOWN )
<a name="l00619"></a>00619     {
<a name="l00620"></a>00620         <span class="keywordtype">double</span> k  = CameraZoom * 2e-3;
<a name="l00621"></a>00621         <span class="keywordtype">double</span> dx = k * ( x - LastMouse.x );
<a name="l00622"></a>00622         <span class="keywordtype">double</span> dy = k * ( y - LastMouse.y );
<a name="l00623"></a>00623 
<a name="l00624"></a>00624         <span class="keywordtype">double</span> phi   = CameraAngle     * <a class="code" href="class_wo_r_b_1_1_const.html#a8931291734002d2f15d76123f2840fc3" title="Represents Pi.">Const::Pi</a> / 180.0;
<a name="l00625"></a>00625         <span class="keywordtype">double</span> theta = CameraElevation * <a class="code" href="class_wo_r_b_1_1_const.html#a8931291734002d2f15d76123f2840fc3" title="Represents Pi.">Const::Pi</a> / 180.0;
<a name="l00626"></a>00626 
<a name="l00627"></a>00627         CameraLookAt.y +=  dy * cos( theta );
<a name="l00628"></a>00628         CameraLookAt.x += -dx * sin( phi ) - dy * cos( phi ) * sin( theta );
<a name="l00629"></a>00629         CameraLookAt.z +=  dx * cos( phi ) - dy * sin( phi ) * sin( theta );
<a name="l00630"></a>00630 
<a name="l00631"></a>00631         <span class="keywordflow">if</span> ( CameraLookAt.y &lt; 0 ) {
<a name="l00632"></a>00632             CameraLookAt.y = 0;
<a name="l00633"></a>00633         }
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635     <span class="keywordflow">else</span>
<a name="l00636"></a>00636     {
<a name="l00637"></a>00637         CameraAngle += 0.25 * ( x - LastMouse.x );
<a name="l00638"></a>00638         <span class="keywordflow">while</span>( CameraAngle &lt; -180.0 ) {
<a name="l00639"></a>00639             CameraAngle += 360.0;
<a name="l00640"></a>00640         }
<a name="l00641"></a>00641         <span class="keywordflow">while</span> ( CameraAngle &gt; 180.0 ) {
<a name="l00642"></a>00642             CameraAngle -= 360.0;
<a name="l00643"></a>00643         }
<a name="l00644"></a>00644 
<a name="l00645"></a>00645         CameraElevation += 0.25 * ( y - LastMouse.y );
<a name="l00646"></a>00646         CameraElevation = std::max( -20.0, std::min( 90.0, CameraElevation ) );
<a name="l00647"></a>00647     }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649     <span class="comment">// Remember the current mouse position</span>
<a name="l00650"></a>00650     <span class="comment">//</span>
<a name="l00651"></a>00651     LastMouse.x = x;
<a name="l00652"></a>00652     LastMouse.y = y;
<a name="l00653"></a>00653 }
<a name="l00654"></a>00654 <span class="comment"></span>
<a name="l00655"></a>00655 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00656"></a>00656 <span class="comment"></span><span class="comment">// Called when GLUT detects a key press.</span>
<a name="l00657"></a>00657 <span class="comment">//</span>
<a name="l00658"></a><a class="code" href="class_wo_r_b___test_bed.html#a69d3bb8660711737344168fdb0f7ebbe">00658</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a69d3bb8660711737344168fdb0f7ebbe" title="Called when GLUT detects a key press.">WoRB_TestBed::KeyboardEventHandler</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> key )
<a name="l00659"></a>00659 {
<a name="l00660"></a>00660     <span class="keywordflow">switch</span>( key )
<a name="l00661"></a>00661     {
<a name="l00662"></a>00662         <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: <span class="comment">// Toggle displaying axes of the rigid bodies</span>
<a name="l00663"></a>00663             ShowBodyAxes = ! ShowBodyAxes;
<a name="l00664"></a>00664             <span class="keywordflow">break</span>;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666         <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: <span class="comment">// Toggle displaying contact info</span>
<a name="l00667"></a>00667             ShowContacts = ! ShowContacts;
<a name="l00668"></a>00668             <span class="keywordflow">break</span>;
<a name="l00669"></a>00669 
<a name="l00670"></a>00670         <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>: <span class="comment">// Toggle fullscreen mode</span>
<a name="l00671"></a>00671             glutFullScreenToggle ();
<a name="l00672"></a>00672             <span class="keywordflow">break</span>;
<a name="l00673"></a>00673 
<a name="l00674"></a>00674         <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>: <span class="comment">// Toggle help mode</span>
<a name="l00675"></a>00675             ShowHelp = ! ShowHelp;
<a name="l00676"></a>00676             <span class="keywordflow">break</span>;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678         <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>: <span class="comment">// Toggle floor mirror</span>
<a name="l00679"></a>00679             ShowFloorMirror = ! ShowFloorMirror;
<a name="l00680"></a>00680             <span class="keywordflow">break</span>;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         <span class="keywordflow">case</span> <span class="charliteral">&#39;Q&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>: <span class="comment">// Quit application</span>
<a name="l00683"></a>00683             IsRunning = <span class="keyword">false</span>;
<a name="l00684"></a>00684             <span class="keywordflow">break</span>;
<a name="l00685"></a>00685 
<a name="l00686"></a>00686         <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>: <span class="comment">// Toggle running the simulation</span>
<a name="l00687"></a>00687             IsPaused = ! IsPaused;
<a name="l00688"></a>00688             <span class="keywordflow">break</span>;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690         <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;\r&#39;</span>: <span class="comment">// Advance only one time-step</span>
<a name="l00691"></a>00691             AutoPause = <span class="keyword">true</span>;
<a name="l00692"></a>00692             IsPaused = <span class="keyword">false</span>;
<a name="l00693"></a>00693             <span class="keywordflow">break</span>;
<a name="l00694"></a>00694 
<a name="l00695"></a>00695         <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>: <span class="comment">// Toggle displaying trajectories</span>
<a name="l00696"></a>00696             ShowTrajectories = ! ShowTrajectories;
<a name="l00697"></a>00697             <span class="comment">// Trajectories.clear ();</span>
<a name="l00698"></a>00698             <span class="keywordflow">break</span>;
<a name="l00699"></a>00699 
<a name="l00700"></a>00700         <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>: <span class="comment">// Toggle displaying state variables</span>
<a name="l00701"></a>00701             ShowStateVariables = ! ShowStateVariables;
<a name="l00702"></a>00702             <span class="keywordflow">break</span>;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704         <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>: <span class="comment">// Toggle wireframe mode</span>
<a name="l00705"></a>00705             Wireframe = ! Wireframe;
<a name="l00706"></a>00706             <span class="keywordflow">break</span>;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708         <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;4&#39;</span>: 
<a name="l00709"></a>00709         <span class="keywordflow">case</span> <span class="charliteral">&#39;5&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;6&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;7&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;8&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;9&#39;</span>:
<a name="l00710"></a>00710             TestSuite = key - <span class="charliteral">&#39;1&#39;</span>;
<a name="l00711"></a>00711             <span class="keywordflow">break</span>;
<a name="l00712"></a>00712     }
<a name="l00713"></a>00713 }
<a name="l00714"></a>00714 <span class="comment"></span>
<a name="l00715"></a>00715 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00716"></a>00716 <span class="comment"></span><span class="comment">// Called when GLUT detects a function key press.</span>
<a name="l00717"></a>00717 <span class="comment">//</span>
<a name="l00718"></a><a class="code" href="class_wo_r_b___test_bed.html#ab63c5d75fd2303d70829897f5a453500">00718</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#ab63c5d75fd2303d70829897f5a453500" title="Called when GLUT detects a function key press.">WoRB_TestBed::SpecialKeyEventHandler</a>( <span class="keywordtype">int</span> key )
<a name="l00719"></a>00719 {
<a name="l00720"></a>00720     <span class="keywordflow">switch</span>( key )
<a name="l00721"></a>00721     {
<a name="l00722"></a>00722         <span class="keywordflow">case</span> GLUT_KEY_F1: <span class="comment">// Follow body 1</span>
<a name="l00723"></a>00723             FollowObject = 0;
<a name="l00724"></a>00724             <span class="keywordflow">break</span>;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726         <span class="keywordflow">case</span> GLUT_KEY_F2: <span class="comment">// Follow body 2</span>
<a name="l00727"></a>00727             FollowObject = 1;
<a name="l00728"></a>00728             <span class="keywordflow">break</span>;
<a name="l00729"></a>00729 
<a name="l00730"></a>00730         <span class="keywordflow">case</span> GLUT_KEY_F3: <span class="comment">// Follow body 3</span>
<a name="l00731"></a>00731             FollowObject = 2;
<a name="l00732"></a>00732             <span class="keywordflow">break</span>;
<a name="l00733"></a>00733 
<a name="l00734"></a>00734         <span class="keywordflow">case</span> GLUT_KEY_F4: <span class="comment">// Follow body 4</span>
<a name="l00735"></a>00735             FollowObject = 3;
<a name="l00736"></a>00736             <span class="keywordflow">break</span>;
<a name="l00737"></a>00737 
<a name="l00738"></a>00738         <span class="keywordflow">case</span> GLUT_KEY_F11: <span class="comment">// Look at coordinate origin, with offset of Oxyz bisectris</span>
<a name="l00739"></a>00739             FollowObject    = 0xFFFFu;
<a name="l00740"></a>00740             CameraLookAt    = 0.0;
<a name="l00741"></a>00741             CameraAngle     = 55.0;
<a name="l00742"></a>00742             CameraElevation = 25.0;
<a name="l00743"></a>00743             CameraZoom      = 20;
<a name="l00744"></a>00744             <span class="keywordflow">break</span>;
<a name="l00745"></a>00745 
<a name="l00746"></a>00746         <span class="keywordflow">case</span> GLUT_KEY_F12: <span class="comment">// Look at coordinate origin, from above</span>
<a name="l00747"></a>00747             FollowObject    = 0xFFFFu;
<a name="l00748"></a>00748             CameraLookAt    = 0.0;
<a name="l00749"></a>00749             CameraAngle     = 0.0;
<a name="l00750"></a>00750             CameraElevation = 90.0;
<a name="l00751"></a>00751             CameraZoom      = 30;
<a name="l00752"></a>00752             <span class="keywordflow">break</span>;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755 }
<a name="l00756"></a>00756 <span class="comment"></span>
<a name="l00757"></a>00757 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00758"></a>00758 <span class="comment"></span><span class="comment">// Clears the current simulation data and prepares a new simulation.</span>
<a name="l00759"></a>00759 <span class="comment">//</span>
<a name="l00760"></a><a class="code" href="class_wo_r_b___test_bed.html#a51218f0aadee04d6a339fb018fdede72">00760</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a51218f0aadee04d6a339fb018fdede72" title="Clears the current simulation data and prepares a new simulation.">WoRB_TestBed::ClearTestBed</a> ()
<a name="l00761"></a>00761 {
<a name="l00762"></a>00762     <span class="comment">// Remove rigid body references from the WoRB solver</span>
<a name="l00763"></a>00763     <span class="comment">//</span>
<a name="l00764"></a>00764     worb.RemoveObjects ();
<a name="l00765"></a>00765 
<a name="l00766"></a>00766     <span class="comment">// Setup default parameters for collision detection/resolve algorithms</span>
<a name="l00767"></a>00767     <span class="comment">//</span>
<a name="l00768"></a>00768     worb.Collisions.Restitution = 1;    <span class="comment">// Coefficient of restitution</span>
<a name="l00769"></a>00769     worb.Collisions.Relaxation  = 0.2;  <span class="comment">// Position projection relaxation coefficient</span>
<a name="l00770"></a>00770     worb.Collisions.Friction    = 0;    <span class="comment">// Dynamic friction coefficient</span>
<a name="l00771"></a>00771 
<a name="l00772"></a>00772     <span class="comment">// Disable gravity</span>
<a name="l00773"></a>00773     <span class="comment">//</span>
<a name="l00774"></a>00774     worb.Gravity = 0.0;
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="comment">// Initialize the ground plane and the walls</span>
<a name="l00777"></a>00777     <span class="comment">//</span>
<a name="l00778"></a>00778     <span class="keywordtype">double</span> boxHalfSize = GridTicks * GridTickLength;
<a name="l00779"></a>00779     GroundPlane.Direction =  <a class="code" href="class_wo_r_b_1_1_const.html#a45b98b11c36297183d278c1563eb89af" title="Represents Y-axis unit vector.">Const::Y</a>;
<a name="l00780"></a>00780     GroundPlane.Offset    =  0.0;
<a name="l00781"></a>00781     BoxWall[0].Direction  =  <a class="code" href="class_wo_r_b_1_1_const.html#a901bf4b38cfefc3e9bf8a5997aa8add7" title="Represents X-axis unit vector.">Const::X</a>; <span class="comment">// left</span>
<a name="l00782"></a>00782     BoxWall[0].Offset     = -boxHalfSize;
<a name="l00783"></a>00783     BoxWall[1].Direction  = -<a class="code" href="class_wo_r_b_1_1_const.html#a901bf4b38cfefc3e9bf8a5997aa8add7" title="Represents X-axis unit vector.">Const::X</a>; <span class="comment">// right</span>
<a name="l00784"></a>00784     BoxWall[1].Offset     = -boxHalfSize;
<a name="l00785"></a>00785     BoxWall[2].Direction  =  <a class="code" href="class_wo_r_b_1_1_const.html#a447554daa1d441df75c9fdd578268bd4" title="Represents Z-axis unit vector.">Const::Z</a>; <span class="comment">// rear</span>
<a name="l00786"></a>00786     BoxWall[2].Offset     = -boxHalfSize;
<a name="l00787"></a>00787     BoxWall[3].Direction  = -<a class="code" href="class_wo_r_b_1_1_const.html#a447554daa1d441df75c9fdd578268bd4" title="Represents Z-axis unit vector.">Const::Z</a>; <span class="comment">// front</span>
<a name="l00788"></a>00788     BoxWall[3].Offset     = -boxHalfSize;
<a name="l00789"></a>00789 
<a name="l00790"></a>00790     <span class="comment">// Add the ground plane and the walls to our WoRB solver</span>
<a name="l00791"></a>00791     <span class="comment">//</span>
<a name="l00792"></a>00792     worb.Add( GroundPlane );
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <span class="comment">// for ( unsigned i = 0; i &lt; 4; ++i ) {</span>
<a name="l00795"></a>00795     <span class="comment">//     worb.Add( BoxWall[i] );</span>
<a name="l00796"></a>00796     <span class="comment">// }</span>
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="comment">// Remove existing trajectories</span>
<a name="l00799"></a>00799     <span class="comment">//</span>
<a name="l00800"></a>00800     Trajectories.clear ();
<a name="l00801"></a>00801     Trajectories.reserve( 10000 );
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     <span class="comment">// Remove existing objects</span>
<a name="l00804"></a>00804     <span class="comment">//</span>
<a name="l00805"></a>00805     <span class="keywordflow">for</span> ( RBObjects::iterator i = Objects.begin(); i != Objects.end(); ++i ) {
<a name="l00806"></a>00806         <span class="keyword">delete</span> *i;
<a name="l00807"></a>00807     }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809     Objects.clear ();
<a name="l00810"></a>00810     Objects.reserve( 64 );
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 <span class="comment"></span>
<a name="l00813"></a>00813 <span class="comment">/////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00814"></a>00814 <span class="comment"></span><span class="comment">// Initializes the test-bed with the default objects according to selected profile.</span>
<a name="l00815"></a>00815 <span class="comment">//</span>
<a name="l00816"></a><a class="code" href="class_wo_r_b___test_bed.html#a941e4a60fe1b5e274241e36b7e2ecb25">00816</a> <span class="keywordtype">void</span> <a class="code" href="class_wo_r_b___test_bed.html#a941e4a60fe1b5e274241e36b7e2ecb25" title="Initializes the test-bed with the default objects according to selected profile.">WoRB_TestBed::ReconfigureTestBed</a> ()
<a name="l00817"></a>00817 {<span class="comment"></span>
<a name="l00818"></a>00818 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00819"></a>00819 <span class="comment"></span>
<a name="l00820"></a>00820     ClearTestBed ();       <span class="comment">// Clear existing simulation, if any.</span>
<a name="l00821"></a>00821     LastDisplayTime = 0;   <span class="comment">// Force display refresh</span>
<a name="l00822"></a>00822 
<a name="l00823"></a>00823     <span class="keywordflow">if</span> ( TestSuite &gt;= 6 ) {
<a name="l00824"></a>00824         <span class="keywordflow">return</span>;
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826 <span class="comment"></span>
<a name="l00827"></a>00827 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00828"></a>00828 <span class="comment"></span>
<a name="l00829"></a>00829     <span class="comment">/* LAB4 */</span>
<a name="l00830"></a>00830 
<a name="l00831"></a>00831     ShowBodyAxes = <span class="keyword">true</span>;
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     <span class="keywordtype">double</span> thick = 0.01;
<a name="l00834"></a>00834     <span class="keywordtype">double</span> v = -1;
<a name="l00835"></a>00835     <span class="keywordtype">double</span> mass = 0.1;
<a name="l00836"></a>00836     <span class="keywordtype">double</span> L = 5.0;
<a name="l00837"></a>00837 
<a name="l00838"></a>00838     <span class="keywordflow">if</span> ( TestSuite &gt;= 1 )
<a name="l00839"></a>00839     {
<a name="l00840"></a>00840         thick = 0.7;
<a name="l00841"></a>00841         v = -20;
<a name="l00842"></a>00842         mass = 10e3;
<a name="l00843"></a>00843     }
<a name="l00844"></a>00844 <span class="comment"></span>
<a name="l00845"></a>00845 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00846"></a>00846 <span class="comment"></span>    <span class="comment">// Add new objects</span>
<a name="l00847"></a>00847 
<a name="l00848"></a>00848     <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>* box1 = <span class="keyword">new</span> <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>(
<a name="l00849"></a>00849         <span class="comment">/*x=*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( -L/2, 3, 0 ), 
<a name="l00850"></a>00850         <span class="comment">/*q=*/</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html#a61e427148c7a198210e6bb784f96f20c" title="Constructs a quaternion from axis angle representation of rotation.">Quaternion::FromAxisAngle</a>( <a class="code" href="class_wo_r_b_1_1_const.html#a8931291734002d2f15d76123f2840fc3" title="Represents Pi.">Const::Pi</a>/2, 0, 1, 0 ),
<a name="l00851"></a>00851         <span class="comment">/*v=*/</span> 0.0, <span class="comment">/*w=*/</span> 0.0,
<a name="l00852"></a>00852         <span class="comment">/*extent=*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( L, thick, L/2 ), <span class="comment">/*mass=*/</span> mass
<a name="l00853"></a>00853     );
<a name="l00854"></a>00854     Objects.push_back( box1 );
<a name="l00855"></a>00855     worb.Add( box1 );
<a name="l00856"></a>00856 <span class="comment"></span>
<a name="l00857"></a>00857 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00858"></a>00858 <span class="comment"></span>
<a name="l00859"></a>00859     <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>* box2 = <span class="keyword">new</span> <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>(
<a name="l00860"></a>00860         <span class="comment">/*x*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( L - v, 3, L/2 ), <span class="comment">/*q=*/</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>( 0, 0, 1, 0 ),
<a name="l00861"></a>00861         <span class="comment">/*v*/</span> v * <a class="code" href="class_wo_r_b_1_1_const.html#a901bf4b38cfefc3e9bf8a5997aa8add7" title="Represents X-axis unit vector.">Const::X</a>, <span class="comment">/*w=*/</span> 0.0,
<a name="l00862"></a>00862         <span class="comment">/*extent=*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( L, thick, L/2 ), <span class="comment">/*mass=*/</span> mass
<a name="l00863"></a>00863     );
<a name="l00864"></a>00864 
<a name="l00865"></a>00865     Objects.push_back( box2 );
<a name="l00866"></a>00866     worb.Add( box2 );
<a name="l00867"></a>00867 <span class="comment"></span>
<a name="l00868"></a>00868 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00869"></a>00869 <span class="comment"></span>
<a name="l00870"></a>00870     <span class="keywordflow">if</span> ( TestSuite &gt;= 1 ) 
<a name="l00871"></a>00871     {
<a name="l00872"></a>00872         <span class="comment">// box2-&gt;Orientation.w -= 1e-4;</span>
<a name="l00873"></a>00873         box2-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a7f5e3a855d14a7f74b3cfaf752e93eab" title="Holds the angular orientation of the rigid body in world space.">Orientation</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#af5d694542001df6372286f87133073ac" title="Holds the real (scalar) part of the quaternion.">w</a> += 1e-4;
<a name="l00874"></a>00874 
<a name="l00875"></a>00875         box1-&gt;RigidBody::Position.y += 1.0;
<a name="l00876"></a>00876         box2-&gt;RigidBody::Position.y += 1.01;
<a name="l00877"></a>00877     }
<a name="l00878"></a>00878 <span class="comment"></span>
<a name="l00879"></a>00879 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00880"></a>00880 <span class="comment"></span>
<a name="l00881"></a>00881     <span class="keywordflow">if</span> ( TestSuite &gt;= 2 &amp;&amp; TestSuite &lt;= 3 )
<a name="l00882"></a>00882     {
<a name="l00883"></a>00883         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; 30; ++i ) {
<a name="l00884"></a>00884         <a class="code" href="class_wo_r_b_1_1_ball.html" title="Encapsulates a rigid body with geometry of a sphere.">Ball</a>* ball = <span class="keyword">new</span> <a class="code" href="class_wo_r_b_1_1_ball.html" title="Encapsulates a rigid body with geometry of a sphere.">Ball</a>(
<a name="l00885"></a>00885             <a class="code" href="namespace_wo_r_b.html#ae08f8f7a2cf1df90794984c2edb33766" title="Gets a quaternion of the given length having a random orientation.">RandomQuaternion</a>( <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( 1, 3, 0 ), <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( 1, 20, 0 ) ),
<a name="l00886"></a>00886             <a class="code" href="namespace_wo_r_b.html#ae08f8f7a2cf1df90794984c2edb33766" title="Gets a quaternion of the given length having a random orientation.">RandomQuaternion</a> (), 
<a name="l00887"></a>00887             <span class="comment">/*v=*/</span> 0.0, <span class="comment">/*w=*/</span> 0.0, <span class="comment">/*r=*/</span> 0.5, <span class="comment">/*mass=*/</span> 1e1
<a name="l00888"></a>00888         );
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         Objects.push_back( ball );
<a name="l00891"></a>00891         worb.Add( ball );
<a name="l00892"></a>00892         }
<a name="l00893"></a>00893     }
<a name="l00894"></a>00894 <span class="comment"></span>
<a name="l00895"></a>00895 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00896"></a>00896 <span class="comment"></span>
<a name="l00897"></a>00897     <span class="keywordflow">if</span> ( TestSuite &gt;= 2 )
<a name="l00898"></a>00898     {
<a name="l00899"></a>00899         worb.Gravity = <a class="code" href="class_wo_r_b_1_1_const.html#a6f767b1e709f2e90002010bf323d6989" title="Gets standard gravity (standard acceleration due to free fall in kg m/s^2).">Const::g_n</a>; <span class="comment">// add gravity</span>
<a name="l00900"></a>00900 
<a name="l00901"></a>00901         ShowBodyAxes = <span class="keyword">false</span>;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903         box1-&gt;<a class="code" href="class_wo_r_b_1_1_cuboid.html#a21f09fa55d5adc0837e04b1759f9ea07" title="Sets body mass and principal moment of inertia of the cuboid.">SetMass</a>( 3 );
<a name="l00904"></a>00904         box1-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a> = 5;
<a name="l00905"></a>00905         box1-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a640f3581983c32fba44aed65b9e72573" title="Controls whether body is allowed to be inactivated.">CanBeDeactivated</a> = <span class="keyword">true</span>;
<a name="l00906"></a>00906 
<a name="l00907"></a>00907         box2-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#ae188cac475b4b6a4d932c6e507160f44" title="Holds the linear position of the rigid body in world space.">Position</a>.<a class="code" href="class_wo_r_b_1_1_quaternion.html#a6f8cac6c6ca2425471915fa8a3f4197e" title="Holds j-component of the pure imaginary (vector) part.">y</a> = 5;
<a name="l00908"></a>00908         box2-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a640f3581983c32fba44aed65b9e72573" title="Controls whether body is allowed to be inactivated.">CanBeDeactivated</a> = <span class="keyword">true</span>;
<a name="l00909"></a>00909     }
<a name="l00910"></a>00910 
<a name="l00911"></a>00911     <span class="keywordflow">if</span> ( TestSuite &gt;= 3 )
<a name="l00912"></a>00912     {
<a name="l00913"></a>00913         worb.Collisions.Restitution = 0.2;
<a name="l00914"></a>00914         worb.Collisions.Friction = 0.2;
<a name="l00915"></a>00915     }
<a name="l00916"></a>00916 
<a name="l00917"></a>00917     <span class="keywordflow">if</span> ( TestSuite &gt;= 4 )
<a name="l00918"></a>00918     {
<a name="l00919"></a>00919         ShowBodyAxes = <span class="keyword">false</span>;
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; 50; ++i )
<a name="l00922"></a>00922         {
<a name="l00923"></a>00923             <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>* box;
<a name="l00924"></a>00924             <span class="keywordflow">if</span> ( TestSuite &gt;= 5 ) {
<a name="l00925"></a>00925                 box2-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a> *= 0.8;
<a name="l00926"></a>00926                 box2-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a09e549a786fcb43c9add018c75d9454f" title="Normalizes orientation and calculates derived quantities from the state variables.">CalculateDerivedQuantities</a>( <span class="keyword">false</span> );
<a name="l00927"></a>00927 
<a name="l00928"></a>00928                 box = <span class="keyword">new</span> <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>(
<a name="l00929"></a>00929                     <span class="comment">/*x*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( L, i * 0.4 + 0.2, L/2 ), 
<a name="l00930"></a>00930                     <span class="comment">/*q*/</span> <a class="code" href="class_wo_r_b_1_1_quaternion.html" title="Encapsulates Hamilton real quaternions.">Quaternion</a>( 1.0 ),
<a name="l00931"></a>00931                     <span class="comment">/*v*/</span> 0.0, <span class="comment">/*w*/</span> 0.0,
<a name="l00932"></a>00932                     <span class="comment">/*extent=*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( 2, 0.2, 2 ),
<a name="l00933"></a>00933                     <span class="comment">/*mass=*/</span> mass
<a name="l00934"></a>00934                 );
<a name="l00935"></a>00935             }
<a name="l00936"></a>00936             <span class="keywordflow">else</span> {
<a name="l00937"></a>00937                 box2-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#abe8138aa4bbcfe9b95ef859d20f32b60" title="Holds the linear velocity of the rigid body in world space.">Velocity</a> = 0.0;
<a name="l00938"></a>00938                 box2-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a09e549a786fcb43c9add018c75d9454f" title="Normalizes orientation and calculates derived quantities from the state variables.">CalculateDerivedQuantities</a>( <span class="keyword">false</span> );
<a name="l00939"></a>00939                 worb.Collisions.Relaxation = 0.0;
<a name="l00940"></a>00940 
<a name="l00941"></a>00941                 box = <span class="keyword">new</span> <a class="code" href="class_wo_r_b_1_1_box.html" title="Encapsulates a rigid body with geometry of a rectangular parallelepiped.">Box</a>(
<a name="l00942"></a>00942                     <span class="comment">/*x*/</span> <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( L, i * 0.4 + 0.2, L/2 ), 
<a name="l00943"></a>00943                     <span class="comment">/*q*/</span> <a class="code" href="namespace_wo_r_b.html#ae08f8f7a2cf1df90794984c2edb33766" title="Gets a quaternion of the given length having a random orientation.">RandomQuaternion</a> (),
<a name="l00944"></a>00944                     <span class="comment">/*v*/</span> 0.0, <span class="comment">/*w*/</span> 0.0,
<a name="l00945"></a>00945                     <span class="comment">/*extent=*/</span> <a class="code" href="namespace_wo_r_b.html#ae08f8f7a2cf1df90794984c2edb33766" title="Gets a quaternion of the given length having a random orientation.">RandomQuaternion</a>(
<a name="l00946"></a>00946                         <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( 0.5, 0.5, 0.5 ), <a class="code" href="class_wo_r_b_1_1_spatial_vector.html" title="Encapsulates a spatial vector.">SpatialVector</a>( 1, 2, 3 ) ),
<a name="l00947"></a>00947                     <span class="comment">/*mass=*/</span> mass
<a name="l00948"></a>00948                 );
<a name="l00949"></a>00949 
<a name="l00950"></a>00950                 box-&gt;<a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#ab41334b7f0ade9014c9a1f3fcc11df2f" title="Holds the shape color, used when body is active (moving).">ActiveColor</a> = <a class="code" href="namespace_wo_r_b.html#ae08f8f7a2cf1df90794984c2edb33766" title="Gets a quaternion of the given length having a random orientation.">RandomQuaternion</a> ();
<a name="l00951"></a>00951                 box-&gt;<a class="code" href="class_wo_r_b_1_1_g_l_u_t___renderer.html#ab41334b7f0ade9014c9a1f3fcc11df2f" title="Holds the shape color, used when body is active (moving).">ActiveColor</a>.<a class="code" href="struct_wo_r_b_1_1_g_l_u_t___renderer_1_1_colorf.html#a2e40aaba78ba95bf8fa8281f86482df3" title="Holds aplpha (transparency) channel.">A</a> = 0.8f;
<a name="l00952"></a>00952             }
<a name="l00953"></a>00953             box-&gt;<a class="code" href="class_wo_r_b_1_1_geometry.html#a2d6b8f9a139f6c44b6214b93be12dd47" title="The rigid body that is represented by this geometry.">Body</a>-&gt;<a class="code" href="class_wo_r_b_1_1_rigid_body.html#a640f3581983c32fba44aed65b9e72573" title="Controls whether body is allowed to be inactivated.">CanBeDeactivated</a> = <span class="keyword">true</span>;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955             Objects.push_back( box );
<a name="l00956"></a>00956             worb.Add( box );
<a name="l00957"></a>00957         }
<a name="l00958"></a>00958     }
<a name="l00959"></a>00959 <span class="comment"></span>
<a name="l00960"></a>00960 <span class="comment">    /////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00961"></a>00961 <span class="comment"></span>    <span class="comment">// Finally, initialize ODE (calculate derived quantities for recently added objects)</span>
<a name="l00962"></a>00962 
<a name="l00963"></a>00963     worb.InitializeODE ();
<a name="l00964"></a>00964 }
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_wo_r_b___test_bed_8cpp.html">WoRB_TestBed.cpp</a>      </li>

    <li class="footer">Generated on Sun Feb 24 2013 14:18:26 for World of Rigid Bodies (WoRB) by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
